!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";function e(t,e){function n(t){return d3.max(t.nodes().map(function(t){return t.getComputedTextLength()}))}function r(t){return function(e){return e.length>t?e.slice(0,t-1)+"â€¦":e}}function a(a){var p,h=e.domain(),g=d3.scaleOrdinal(o),m=r(d),v=a.selectAll(".row").data(h,e).order(),y=v.enter().append("g").attr("class","row"),x=v.exit();if(v=v.merge(y).attr("transform",function(t){return"translate(0,"+e(t)+")"}),x.remove(),y.append("rect").attr("y",.5).attr("width",c).attr("height",e.bandwidth()).attr("stroke",u).attr("stroke-width",.75).attr("fill",g),t!==f){var w=v.select("text");w=w.merge(y.append("text").attr("y",e.bandwidth()/2).attr("dy","0.32em")).text(m);var b=.2*c;p=n(w)+l+l,p=Math.min(b,p),p=t===s?c-p:p,i=t===s?[0,p]:[p,c],w.attr("text-anchor",t===s?"start":"end").attr("dx",t===s?l:-l).attr("x",p)}else i=[0,c],p=0;a.append("path").attr("stroke",u).attr("d","M"+(p+.5)+",0.5V"+e.range()[1])}var i,o=["#FFF","#EEE"],l=5,u="#AAA",d=40,c=100;return a.draw_ticks=function(t,n){t.selectAll(".row").select("path").attr("d",n.map(function(t){return"M"+t+",1v"+(e.bandwidth()-1)}).join(""))},a.scale=function(t){return arguments.length?(e=t,a):e},a.width=function(t){return arguments.length?(c=t,a):c},a.colors=function(t){return arguments.length?(o=t,a):o},a.padding=function(t){return arguments.length?(l=t,a):l},a.range=function(t){return arguments.length?(i=t,a):i},a.trim=function(t){return arguments.length?(d=t,a):d},a}function n(t){return e(c,t)}function r(t){return e(s,t)}function a(t){return e(f,t)}function i(t){function e(t){return Math.round(10*t)/10}return t<120?t+"s":t<7200?e(t/60)+" min":t<172800?e(t/3600)+" hours":t<5184e3?e(t/86400)+" day(s)":t<63072e3?e(t/2592e3)+" month(s)":e(t/31536e3)+" year(s)"}function o(t){return function(e){return void 0===t?e:e[t]}}function l(t){var e=window.getComputedStyle(t,null).getPropertyValue("font-size");return parseFloat(e)}function u(t,e){return"translate("+t+","+e+")"}var d=function(t,e){t||(t="body");var n=d3.select(t).append("div").style("position","absolute").style("padding","10px").style("background","#fff").style("border","1px solid #aaa").style("border-radius","2px").style("z-index","32767").style("pointer-events","none").style("opacity",0),r=n.node();return n.show=function(t,a,i){var o=i[0].attributes["data-y"].value,l=parseInt(i[0].attributes.x.value);n.html(e.apply(null,[t,a,i])).style("left","unset").style("right","unset"),l+r.clientWidth+10>r.parentNode.clientWidth?n.style("right","10px").style("left","unset").style("top",o+"px"):n.style("left",l+"px").style("right","unset").style("top",o+"px"),n.transition().duration(100).style("opacity",.95)},n.hide=function(){n.transition().duration(100).style("opacity",0)},n},s=1,c=2,f=0,p=function(){function t(t){function i(t){if(0===t)return 0;if(1===t)return.5;var e=Math.floor(Math.log2(t)),n=Math.pow(2,e),r=t-n;return(e%2==1?r%2==0?r+1:r+n:r%2==0?n-r-1:n+n-r)/(n+n)}function o(t){var e;if(f&&void 0===(e=f[t])&&(e=m.get(t)),void 0===e){var n=i(w);e=d3.hcl(360*n,75,65),w++,m.set(t,e)}return e}var m=new Map,w=0,b=t.datum(),k=d3.map(b,function(t){return t.label}).keys();s=s||[d3.min(b,function(t){return t.start}),d3.max(b,function(t){return t.end})],t.each(function(i){var f,m=c||this.getBoundingClientRect().width,w=k.length*(l(this)+4*p),b=d3.scaleBand().domain(k).range([0,w]),A=d3.scaleTime().domain(s);f=1===i.length?a(b).width(m):(h?r:n)(b).width(m);var M=d3.select(this);M.style("position","relative"),M.select("div").remove(),M.select("svg").remove();var F=M.append("svg").attr("class","timeline"),_=new d(this,e);F.attr("width",m),F.attr("height",w+20);var C=F.append("g"),j=C.append("g").attr("class","y axis").call(f),B=f.range();A.range([B[0],B[1]]).clamp(!0);var E=d3.axisBottom(A),L=C.append("g").attr("class","x axis").attr("transform",u(0,w)).call(E);L.select(".domain").remove(),L.selectAll(".tick line").attr("stroke","#AAA").attr("stroke-width",.75).attr("y1",-w);var P=A.ticks().map(A);j.call(f.draw_ticks,P);var T=p+p,V=i.map(function(t){return b(t.label)+p}),z=b.bandwidth()-T;C.append("g").selectAll("g").data(i).enter().append("g").attr("transform",function(t){return"translate(0, "+b(t.label)+")"}).classed("task",!0).each(function(t,e,n){d3.select(n[e]).selectAll("rect").data(function(t){return t.data}).enter().each(function(t,n,r){var a=d3.select(r[n]),i=o(v(t)),l=A(y(t)),u=A(x(t))-l;if(a.append("rect").attr("y",5).attr("x",l).attr("width",u+.5).attr("height",z).attr("data-y",V[e]+z).on("mouseover",_.show).on("mouseout",_.hide).attr("fill",i),u>T){var d=v(t),s=a.append("text").attr("x",l).attr("y",5).attr("dx",p).attr("dy",z/2+p).attr("text-anchor","start").attr("fill","black").attr("pointer-events","none").text(d);u-p<s.node().getComputedTextLength()&&s.remove()}})}),g&&t.append("path").attr("stroke","red").attr("d","M"+A(new Date)+",0.5V"+w)})}function e(t){var e,n=(x(t)-y(t))/1e3;e=n<64800?"%H:%M:%S":n<604800?"%m-%d %H:%M":"%Y-%m-%d";var r=function(t){return d3.timeFormat(e)(d3.isoParse(t))};return"<b>"+v(t)+'</b><hr style="margin: 2px 0 2px 0">'+r(y(t))+" - "+r(x(t))+"<br>"+i(n)}var s,c,f,p=5,h=!1,g=!1,m=0,v=o(0),y=o(1),x=o(2);return t.dates=function(e){return arguments.length?(s=e,t):s},t.width=function(e){return arguments.length?(const_width=e,t):const_width},t.today=function(e){return arguments.length?(g=e,t):g},t.colors=function(e){return arguments.length?(colors=e,t):colors},t.padding=function(e){return arguments.length?(p=e,t):p},t.reversed=function(e){return arguments.length?(h=e,t):h},t.duration=function(e){return arguments.length?(m=e,t):m},t.knownColor=function(e){return arguments.length?(f=e,t):f},t};t.timeline=p,t.tooltip=d,t.timelineAxisLeft=n,t.timelineAxisRight=r,t.durationFormat=i,Object.defineProperty(t,"__esModule",{value:!0})});